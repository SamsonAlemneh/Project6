<!DOCTYPE html>
<html>
<head>
	<title>Upload Image and Add Draggable Circle Object to Canvas</title>
	<style>
		canvas {
			border: 1px solid #ccc;
		}
	</style>
</head>
<body>
	<input type="file" id="file-input">
	<canvas id="canvas"></canvas>
	<button id="save-button">Save</button>

	<script>
		// Get the canvas element
		var canvas = document.getElementById("canvas");

		// Get the context of the canvas
		var ctx = canvas.getContext("2d");

		// Set the canvas width and height
		canvas.width = 500;
		canvas.height = 500;

		// Create an empty image object
		var img = new Image();

		// Handle image upload
		document.getElementById("file-input").addEventListener("change", function (e) {
			// Get the uploaded file
			var file = e.target.files[0];

			// Set the image source to the uploaded file
			img.src = URL.createObjectURL(file);

			// When the image has loaded, draw it on the canvas
			img.onload = function () {
				ctx.drawImage(img, 0, 0);
			};
		});

		// Create an object to represent the circle
		var circle = {
			x: 250,
			y: 250,
			radius: 10,
			color: "#ff0000"
		};

		// Draw the circle on the canvas
		function drawCircle() {
			ctx.beginPath();
			ctx.arc(circle.x, circle.y, circle.radius, 0, 2 * Math.PI);
			ctx.fillStyle = circle.color;
			ctx.fill();
			ctx.closePath();
		}

		// Draw the initial circle
		drawCircle();

		// Add event listeners to make the circle draggable
		var isDragging = false;
		canvas.addEventListener("mousedown", function (e) {
			// Calculate the distance between the mouse click and the center of the circle
			var distance = Math.sqrt(Math.pow(circle.x - e.offsetX, 2) + Math.pow(circle.y - e.offsetY, 2));

			// If the mouse click is inside the circle, set isDragging to true
			if (distance <= circle.radius) {
				isDragging = true;
			}
		});

		canvas.addEventListener("mousemove", function (e) {
			// If the circle is being dragged, update its position
			if (isDragging) {
				circle.x = e.offsetX;
				circle.y = e.offsetY;

				// Clear the canvas and redraw the image and circle
				ctx.clearRect(0, 0, canvas.width, canvas.height);
				ctx.drawImage(img, 0, 0);
				drawCircle();
			}
		});

		canvas.addEventListener("mouseup", function (e) {
			// Set isDragging to false when the mouse is released
			isDragging = false;
		});

		// Save the canvas as an image
		document.getElementById("save-button").addEventListener("click", function () {
			var link = document.createElement("a");
			link.download = "canvas.png";
			link.href = canvas.toDataURL("image/png");
			link.click();
		});
	</script>
</body>
</html>
